"use strict";(()=>{var e={};e.id=382,e.ids=[382],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},99880:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>b,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>u,serverHooks:()=>y,staticGenerationAsyncStorage:()=>A});var a={};r.r(a),r.d(a,{DELETE:()=>p,GET:()=>d,PATCH:()=>h,POST:()=>c});var o=r(49303),i=r(88716),s=r(60670),n=r(87070),l=r(13114);async function d(){try{let e=await l.o.getAllTestimonials();return n.NextResponse.json(e)}catch(e){return console.error("❌ Failed to fetch testimonials:",e),n.NextResponse.json({error:"Failed to fetch testimonials"},{status:500})}}async function c(e){try{let t=await e.json(),r=await l.o.createTestimonial(t);return console.log("✅ Testimonial created:",r),n.NextResponse.json(r)}catch(e){return console.error("❌ Failed to create testimonial:",e),n.NextResponse.json({error:"Failed to create testimonial"},{status:500})}}async function h(e){try{let{id:t,...r}=await e.json();if(!t)return n.NextResponse.json({error:"Testimonial ID is required"},{status:400});let a=await l.o.updateTestimonial(t,r);return console.log("✅ Testimonial updated:",a),n.NextResponse.json(a)}catch(e){return console.error("❌ Failed to update testimonial:",e),n.NextResponse.json({error:"Failed to update testimonial"},{status:500})}}async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("id");if(!r)return n.NextResponse.json({error:"Testimonial ID is required"},{status:400});return await l.o.deleteTestimonial(r),console.log("✅ Testimonial deleted:",r),n.NextResponse.json({success:!0})}catch(e){return console.error("❌ Failed to delete testimonial:",e),n.NextResponse.json({error:"Failed to delete testimonial"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/testimonials/route",pathname:"/api/testimonials",filename:"route",bundlePath:"app/api/testimonials/route"},resolvedPagePath:"/Users/erosnolasco-mendoza/Documents(non-iCloud)/VSCode/delphincleanair/app/api/testimonials/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:A,serverHooks:y}=u,b="/api/testimonials/route";function f(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:A})}},13114:(e,t,r)=>{r.d(t,{hV:()=>a,o:()=>i});class a{constructor(){this.baseId=process.env.AIRTABLE_BASE_ID||"",this.apiKey=process.env.AIRTABLE_API_KEY||"",this.tableName="Leads"}async createLead(e){let t=`https://api.airtable.com/v0/${this.baseId}/${this.tableName}`;try{let r=await fetch(t,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({fields:{"First Name":e.firstName,"Last Name":e.lastName,Email:e.email,Phone:e.phone,Address:e.details?.address||"",Source:"air-washer-gift"===e.source?"air-washer-gift":e.source,Details:JSON.stringify(e.details),"Created At":new Date().toISOString().split("T")[0],Status:"New"}})}),a=await r.json();if(!r.ok)throw console.error("❌ Airtable API error details:",a),Error(`Airtable API error: ${r.status} - ${JSON.stringify(a)}`);return a}catch(e){throw console.error("❌ Failed to create lead in Airtable:",e),e}}async getLeads(){let e=`https://api.airtable.com/v0/${this.baseId}/${this.tableName}`;try{let t=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}});if(!t.ok)throw Error(`Airtable API error: ${t.status}`);return await t.json()}catch(e){throw console.error("Failed to fetch leads from Airtable:",e),e}}}class o{constructor(){this.baseId=process.env.AIRTABLE_BASE_ID||"",this.apiKey=process.env.AIRTABLE_API_KEY||"",this.tableName="Testimonials"}async createTestimonial(e){let t=`https://api.airtable.com/v0/${this.baseId}/${this.tableName}`;try{let r=await fetch(t,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({fields:{Type:e.type,Content:e.content,Author:e.author,Location:e.location||"",Rating:e.rating||0,"Video URL":e.videoUrl||"","Image URL":e.imageUrl||"","TikTok URL":e.tiktokUrl||"",Date:e.date||new Date().toISOString().split("T")[0],"Is Approved":e.isApproved||!1,"Created At":new Date().toISOString().split("T")[0]}})}),a=await r.json();if(!r.ok)throw console.error("❌ Airtable API error details:",a),Error(`Airtable API error: ${r.status} - ${JSON.stringify(a)}`);return a}catch(e){throw console.error("❌ Failed to create testimonial in Airtable:",e),e}}async getTestimonials(){let e=`https://api.airtable.com/v0/${this.baseId}/${this.tableName}?filterByFormula=AND({Is Approved}=TRUE())&sort[0][field]=Created At&sort[0][direction]=desc`;try{let t=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}}),r=await t.json();if(!t.ok)throw console.error("❌ Airtable API error details:",r),Error(`Airtable API error: ${t.status} - ${JSON.stringify(r)}`);return r}catch(e){throw console.error("❌ Failed to get testimonials from Airtable:",e),e}}async getAllTestimonials(){let e=`https://api.airtable.com/v0/${this.baseId}/${this.tableName}?sort[0][field]=Created At&sort[0][direction]=desc`;try{let t=await fetch(e,{headers:{Authorization:`Bearer ${this.apiKey}`}}),r=await t.json();if(!t.ok)throw console.error("❌ Airtable API error details:",r),Error(`Airtable API error: ${t.status} - ${JSON.stringify(r)}`);return r}catch(e){throw console.error("❌ Failed to get all testimonials from Airtable:",e),e}}async updateTestimonial(e,t){let r=`https://api.airtable.com/v0/${this.baseId}/${this.tableName}/${e}`;try{let e={};t.type&&(e.Type=t.type),t.content&&(e.Content=t.content),t.author&&(e.Author=t.author),void 0!==t.location&&(e.Location=t.location),void 0!==t.rating&&(e.Rating=t.rating),void 0!==t.videoUrl&&(e["Video URL"]=t.videoUrl),void 0!==t.imageUrl&&(e["Image URL"]=t.imageUrl),void 0!==t.tiktokUrl&&(e["TikTok URL"]=t.tiktokUrl),t.date&&(e.Date=t.date),void 0!==t.isApproved&&(e["Is Approved"]=t.isApproved);let a=await fetch(r,{method:"PATCH",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({fields:e})}),o=await a.json();if(!a.ok)throw console.error("❌ Airtable API error details:",o),Error(`Airtable API error: ${a.status} - ${JSON.stringify(o)}`);return o}catch(e){throw console.error("❌ Failed to update testimonial in Airtable:",e),e}}async deleteTestimonial(e){let t=`https://api.airtable.com/v0/${this.baseId}/${this.tableName}/${e}`;try{let e=await fetch(t,{method:"DELETE",headers:{Authorization:`Bearer ${this.apiKey}`}});if(!e.ok){let t=await e.json();throw console.error("❌ Airtable API error details:",t),Error(`Airtable API error: ${e.status} - ${JSON.stringify(t)}`)}return{deleted:!0}}catch(e){throw console.error("❌ Failed to delete testimonial from Airtable:",e),e}}}let i=new o}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,972],()=>r(99880));module.exports=a})();